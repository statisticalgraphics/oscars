--- 
title: "Oscars Over the Years"
author: "Zoey Wee & Shreya Rao"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
---
```{r include=FALSE, cache=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE
)
```

# Introduction

We hear a lot of coverstaion surrounding diversity and inclucivity all around the world. Now there is an increasing number of people belonging to minority groups in positions of prominence. Movies are such a central part of our world and is almost a represenattion of us as a socity throughtout history. Since both of us are movie lovers, we were decided to focus on analyzing trends of diversity in movies. Movies are so universally loved, so we believe that asking questions in this context is the best way to spark these important conversations. Since the Oscars is synonomous with movies, we decided to study a couple of aspects of the Oscars over the years. 

Two pivotal questions we had were: 
1)	Is there a racial disparity among actors? 
2)	Are movies that have female lead roles as popular as those that have male lead roles?

After collecting our data and pondering more about questions we wanted answers to, we decided to broaden our Oscar analysis to include a wider and more general overview of the Oscars while also answering the above two questions.  

In order to gain insights, we first tried to look for a relationship between the “popularity” and “goodness” of movies. We assumed the goodness of a movie is determined by Oscar nominations and wins, and popularity is quantified by box office success. We also explored if there is a relationship between the number of times actors were nominationed and whether they actually win the award or not. Next, we explored how the proportion of actors of color nominted for an Oscar has changed over the years. Finally, we tried to figure out whether there has been gender disparity in the setting of Oscars and box office as well. We believe that this project can serve as a positive agent catalyzing healthy discussions about the media industry and our society as well. 

<!--chapter:end:index.Rmd-->

```{r include=FALSE, cache=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE
)
```
# Data sources

1. We collected our data for the list of all Oscars winners and nominees over the years (1927-2021) for best actor, best actress, best supporting actor, and best supporting actress by web scraping from Wikipedia.
The variables of these data sets are Year, Name of Actor/Actress, Role, and Film.
https://en.wikipedia.org/wiki/Academy_Award_for_Best_Actor
https://en.wikipedia.org/wiki/Academy_Award_for_Best_Actress
https://en.wikipedia.org/wiki/Academy_Award_for_Best_Supporting_Actor
https://en.wikipedia.org/wiki/Academy_Award_for_Best_Supporting_Actress


2. We collected our data for the list of black/Latin/Asian Oscars winners and nominees over the years for best actor, best actress, best supporting actor, and best supporting actress by web scraping from Wikipedia.
The variables of these data sets are Year, Name of Actor/Actress, Role, Film, Status (Won or Nominated), and Milestone.
https://en.wikipedia.org/wiki/List_of_black_Academy_Award_winners_and_nominees
https://en.wikipedia.org/wiki/List_of_Latin_American_Academy_Award_winners_and_nominees
https://en.wikipedia.org/wiki/List_of_Asian_Academy_Award_winners_and_nominees


3. We collected the list of Best Picture Oscar nominees and winners by year by web scraping from imdb. The variables are Year, Movie, Running Time, Genre, and Rating.
https://www.imdb.com/list/ls009487211/


4. We collected the box office data for the films that won Oscars Best Picture from 1980 to 2021 by web scraping. The variables of this data set are Release Date, Movie, Production Budget, Domestic Opening Weekend, and Domestic Box Office. We also collected the box office data for the highest grossing movie for each year from 1977 to 2021 by web scraping. The variables of this data set are Release Group(=Movie), Worldwide box office Domestic box office, and Foreign box office.
https://www.the-numbers.com/movies/comparisons/Best-Picture-Oscar-Winners
https://www.boxofficemojo.com/year/world/2019/?sort=domesticGrossToDate&ref_=bo_ydw__resort#table


5. We collected the list of Oscars Best Picture Winners with female leads over the years (which turned out to be only 16 cases), and the box office data for the best picture winners and nominations for those 16 years by web scraping. The variables of the first data set are Year and Movie, and for the latter one were Year, Movie, Box office, and Status(Won or Nominated).
https://www.refinery29.com/en-us/oscar-best-picture-winners-women-lead#slide-16
https://www.ultimatemovierankings.com/




<!--chapter:end:02-data.Rmd-->

```{r include=FALSE, cache=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE
)
```
# Data transformation


We wrote three functions to particularly scrape the Wikipedia tables. We obtained information about the Oscars winners and nominees over the years (1927-2021) for best actor, best actress, best supporting actor, and best supporting actress, and stored them in the data frames actor_lead, actress_lead, actor_sup, actress_sup respectively. 

There were separate tables for each year on Wikipedia, so we combined the rows to make it into one data frame for each category. 

We used the same method for the black/Latin/Asian lead/supporting actors and actresses, and stored them in data frames black_actor_lead, black_actor_sup, black_actress_lead, black_actress_sup, and so on with Latin and Asian as well. We found one Egyptian Best Actor winner and put it in a single-row data frame. 


```{r}
library(tidyverse)
library(rvest)
library(readxl)
```



```{r}
##functions
extract_table_poc <- function(html, n) {
  #extract nth table from html
  nth_table <- html %>%
    html_nodes(css = "table") %>% 
    nth(n) %>% 
    html_table(fill = TRUE)
  
  colnames(nth_table) <- nth_table[2,]
  nth_table <- nth_table[3:nrow(nth_table),]
  
  return(nth_table)
}

extract_table <- function(html, n) {
  #extract nth table from html
  nth_table <- html %>%
    html_nodes(css = "table") %>% 
    nth(n) %>% 
    html_table(fill = TRUE)
  
  return(nth_table)
}


#extract year from scraped tables
year_change <- function(year) {
  t <- as.numeric(str_extract(str_extract(string = year, pattern = "\\([0-9]+[a-z]+\\)"), "[0-9]+")) + 1927
  return(t)
}
```

## Black Lead Actors and Actresses
```{r}
#black lead/supporting actors and actresses
black_actors_html = read_html("https://en.wikipedia.org/wiki/List_of_black_Academy_Award_winners_and_nominees")

black_actor_lead <- extract_table_poc(black_actors_html, 2)
black_actress_lead <- extract_table_poc(black_actors_html, 3)
black_actor_sup <- extract_table_poc(black_actors_html, 4)
black_actress_sup <- extract_table_poc(black_actors_html, 5)

head(black_actor_lead, 3)
head(black_actress_lead, 3)
```

## Latin Lead Actors and Actresses
```{r}
#latin lead/supporting actors and actress
latin_actors_html <- read_html("https://en.wikipedia.org/wiki/List_of_Latin_American_Academy_Award_winners_and_nominees")

latin_actor_lead <- extract_table_poc(latin_actors_html, 4) %>% select(Year, Nominee, Film, Result)
latin_actress_lead <- extract_table_poc(latin_actors_html, 5) %>% select(Year, Nominee, Film, Result)
latin_actor_sup <- extract_table_poc(latin_actors_html, 6) %>% select(Year, Nominee, Film, Result)
latin_actress_sup <- extract_table_poc(latin_actors_html, 7) %>% select(Year, Nominee, Film, Result)

head(latin_actor_lead, 3)
head(latin_actress_lead, 3)
```

## Asian Lead Actors and Actresses
```{r}
#asian lead/supporting actors and actress
asian_actors_html <- read_html("https://en.wikipedia.org/wiki/List_of_Asian_Academy_Award_winners_and_nominees")

asian_actor_lead <- extract_table_poc(asian_actors_html, 2) %>% select(Year, Name, Film, Status)
asian_actress_lead <- extract_table_poc(asian_actors_html, 3) %>% select(Year, Name, Film, Status)
asian_actor_sup <- extract_table_poc(asian_actors_html, 4) %>% select(Year, Name, Film, Status)
asian_actress_sup <- extract_table_poc(asian_actors_html, 5) %>% select(Year, Name, Film, Status)
head(asian_actor_lead,3)
head(asian_actress_lead,3)
#egyptian
egyptian_actor_lead <- data.frame(Year = "2018", Name = "Rami Malek", Film = "Bohemian Rhapsody", Status = "Won")
```


## Egyptian Lead Actor

```{r}
head(egyptian_actor_lead,3)
```


## All Supporting Actors and Actresses

```{r}
#all supporting actors
actor_sup_html <- read_html("https://en.wikipedia.org/wiki/Academy_Award_for_Best_Supporting_Actor")

actor_sup <- NULL
for(i in 3:12) {
  actor_sup <- rbind(actor_sup, extract_table(actor_sup_html, i))
}

actor_sup <- actor_sup %>% mutate(Year = year_change(actor_sup$Year)) %>% select(Year, Actor, Film)
head(actor_sup,3)
#cleaning actor name
actor_sup$Actor <- str_replace(actor_sup$Actor, pattern = "\\[[^\\]]+\\]", "")
actor_sup$Actor <- str_replace(actor_sup$Actor, pattern = "\\([^\\)]+\\)", "")
actor_sup$Actor <- str_replace(actor_sup$Actor, pattern = "§", "")
actor_sup$Actor <- str_replace(actor_sup$Actor, pattern = "†", "")
actor_sup$Actor <- trimws(actor_sup$Actor)


#all supporting actresses
actress_sup_html <- read_html("https://en.wikipedia.org/wiki/Academy_Award_for_Best_Supporting_Actress")

actress_sup <- NULL
for(i in 3:12) {
  actress_sup <- rbind(actress_sup, extract_table(actress_sup_html, i))
}

actress_sup <- actress_sup %>% mutate(Year = year_change(actress_sup$Year)) %>% select(Year, Actress, Film)
head(actress_sup,3)
```


## All Lead Actors and Actresses

```{r}
#all lead actors
actor_lead_html <- read_html("https://en.wikipedia.org/wiki/Academy_Award_for_Best_Actor")

actor_lead <- NULL
for(i in 3:13) {
  actor_lead <- rbind(actor_lead, extract_table(actor_lead_html, i))
}

actor_lead <- actor_lead %>% mutate(Year = year_change(actor_lead$Year)) %>% select(Year, Actor, Film)
actor_lead$Actor <- str_replace(actor_lead$Actor, pattern = "\\[[^\\]]+\\]", "")
actor_lead$Actor <- str_replace(actor_lead$Actor, pattern = "\\([^\\)]+\\)", "")
actor_lead$Actor <- str_replace(actor_lead$Actor, pattern = "§", "")
actor_lead$Actor <- str_replace(actor_lead$Actor, pattern = "†", "")
actor_lead$Actor <- trimws(actor_lead$Actor)

#all lead actress
actress_lead_html <- read_html("https://en.wikipedia.org/wiki/Academy_Award_for_Best_Actress")

actress_lead <- NULL
for(i in 3:13) {
  actress_lead <- rbind(actress_lead, extract_table(actress_lead_html, i))
}

actress_lead <- actress_lead %>% mutate(Year = year_change(actress_lead$Year)) %>% select(Year, Actress, Film)

#cleaning actress names
actress_lead$Actress <- str_replace(actress_lead$Actress, pattern = "\\[[^\\]]+\\]", "")
actress_lead$Actress <- str_replace(actress_lead$Actress, pattern = "\\([^\\)]+\\)", "")
actress_lead$Actress <- trimws(actress_lead$Actress)

head(actor_lead,3)
head(actress_lead,3)
```


## Highest Grossing Movies (1977 - 2021)

For the box office data for the highest grossing movies from 1977-2021, we found separate data sets for the box office of each year (1977-2021) and wrote for loops to scrape the Movie and the Box office earnings of the row with the highest domestic grossing value, and made a variable Year. We cleaned the numbers for the box office earnings as well. The resulting data set is a 45x3 data frame.

```{r}
link1 <- "https://www.boxofficemojo.com/year/world/"
link2 <- "/?sort=domesticGrossToDate&ref_=bo_ydw__resort#table"

#highest_grossing <- NULL

# for(i in 1977:2021) {
#   temp_link <- paste(link1, as.character(i), link2, sep="")
#   temp_html <- read_html(temp_link)
#   movie_table <- temp_html %>% html_nodes("table") %>% html_table(fill = T)
#   movie <- movie_table[[1]][1,]
#   highest_grossing <- rbind(highest_grossing, movie) 
# }

highest_grossing <- data.frame(Movie=character(45), Domestic=character(45))
index <- 1

for(i in 1977:2021) {
  temp_link <- paste(link1, as.character(i), link2, sep="")
  temp_html <- read_html(temp_link)
  highest_grossing$Movie[index] <- temp_html %>% html_nodes("td") %>% html_text %>% nth(2)
  highest_grossing$Domestic[index] <- temp_html %>% html_nodes("td") %>% html_text %>% nth(4)
  index <- index + 1
}

highest_grossing <- highest_grossing %>% mutate(Year = 1977:2021) %>% rename(Overall_Movie = Movie, Overall_Boxoffice = Domestic) 
#coverting boxoffice to numeric
highest_grossing$Overall_Boxoffice <- as.numeric(gsub("\\$|,", "", highest_grossing$Overall_Boxoffice))

head(highest_grossing, 3)
```


## Box office earnings of Oscar Best Picture 1980 - 2021

For box office earnings for Oscar Best Picture (1980-2021), we first read in the table, selected "Movie", "Domestic Box Office", "Release Date" columns, renamed them appropriately, modified "Release Date" to make a new column "Year, and cleaned the numbers such as removing dollar signs and commas for the box office earnings. The resulting data set is a 41x4 data frame. 

```{r}
oscar_bo_html <- read_html("https://www.the-numbers.com/movies/comparisons/Best-Picture-Oscar-Winners")

oscar_bo <- (oscar_bo_html %>% html_nodes("table") %>% html_table(fill = T))[[1]]
oscar_bo <- oscar_bo %>% select(Movie, "DomesticBox Office", "Release Date") %>% rename(Oscar_Boxoffice = "DomesticBox Office", "Oscar_Movie" = Movie)

#adding release year
oscar_bo$Year <- as.numeric(substr(oscar_bo$`Release Date`, nchar(oscar_bo$`Release Date`)-3, nchar(oscar_bo$`Release Date`)))
#coverting boxoffice to numeric
oscar_bo$Oscar_Boxoffice <- as.numeric(gsub("\\$|,", "", oscar_bo$Oscar_Boxoffice))

head(oscar_bo,3)
```


## Oscar Best Picture Winners with Female Lead

For the list of Oscar Best Picture winners with female lead, we added the corresponding Year and Movie to an excel file with those as the columns and read it in a data frame.

```{r}
library(readxl)
female_winners<- read_xlsx("data/women.xlsx")

head(female_winners,3)
```


## Box office of Winners with female lead and the Nominees that year 

For the box office data of Winners with female lead and the Nominees of those 16 years, we found 16 separate data set for the whole box office of those years, selected for each year the rows of the winner and the nominees, and added them to an excel file and read it into a data frame. 

```{r}
female_nom_bo<-read_xlsx("data/female_nominees_bo.xlsx")
head(female_nom_bo,3)
```


## IMDB Ratings of Oscar 

For the IMDB data for Oscars Best Picture winners and nominations over the years (1939-2021), we scraped Movie, Year, Genre, Running time, Rating and the link for the image of the movie poster to make it into a data frame.

```{r}
imdb_htmls <- c("https://www.imdb.com/list/ls009487211/", "https://www.imdb.com/list/ls009487211/?sort=list_order,asc&st_dt=&mode=detail&page=2", "https://www.imdb.com/list/ls009487211/?sort=list_order,asc&st_dt=&mode=detail&page=3", "https://www.imdb.com/list/ls009487211/?sort=list_order,asc&st_dt=&mode=detail&page=4", "https://www.imdb.com/list/ls009487211/?sort=list_order,asc&st_dt=&mode=detail&page=5")

imdb_oscar <- data.frame(Movie=character(0), Year=numeric(0), Genre=character(0), Time=character(0), Rating=numeric(0), Image=character(0))

for(html in imdb_htmls) {
  imdb <- read_html(html)
  #img_src <- imdb %>% html_nodes(".loadlate") %>% html_attr("src")
  movie <- head(imdb %>% html_nodes(".loadlate") %>% html_attr("alt"), -2)
  rating <- imdb %>% html_nodes("span.ipl-rating-star__rating") %>% html_text() %>% parse_number()
  rating <- rating[c(TRUE, rep(FALSE, 22))]
  year <- imdb %>% html_nodes(".lister-item-header") %>% html_text()
  year <- as.numeric(substring(str_extract(year, pattern = "\\([0-9]+\\)"), 2, 5))
  genre <- imdb %>% html_nodes("span.genre") %>% html_text()
  time <- imdb %>% html_nodes("span.runtime") %>% html_text()
  img <- imdb %>% html_nodes("img") %>% html_attr('loadlate')
  img <- img[!is.na(img)]
  img <- head(unique(img), -1)
  imdb_oscar <- rbind(imdb_oscar, data.frame(Movie=movie, Year=year, Genre=genre, Time=time, Rating=rating, Image=img))
}


head(imdb_oscar,3)
```

## Number of Times Actors won an Oscar

```{r}
actor_wins <- read_xlsx("data/actors_num_wins.xlsx", col_names = c("Name", "Wins"))
head(actor_wins, 3)
```


## Number of Times Actresses won an Oscar

```{r}
actress_wins <- read_xlsx("data/actresses_num_wins.xlsx", col_names = c("Name", "Wins"))
head(actress_wins, 3)
```


We have 18 data sets including actor_lead, actress_lead, actor_sup, actress_sup, black_actor_lead, black_actress_lead, latin_actor_lead, latin_actress_lead, asian_actor_lead, asian_actress_lead, egyptian_actor_lead, highest_grossing, oscar_bo, female_winners, female_nom_bo, actor_wins, actress_wins, and imdb_oscar.

<!--chapter:end:03-cleaning.Rmd-->

```{r include=FALSE, cache=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE
)
```
# Missing values


In the process of web scraping the tables of winners and nominees of Oscars Best Actor/Actress and Best Supporting Actor/Actress over the years(overall and people of color), we found several missing values in the actress_lead and actress_sup data sets. We believe it happened while scraping multiple tables that were separated by year. The missing values were taken care of using drop_na(). For the box office data of the highest grossing film and Best Picture nominations each year, we had no missing values. Since we collected the variables that we want to use for the Best Picture winners with female lead and the rows with the corresponding years of the box office data for the nominations, there were no missing values for those data sets. The imdb data was not in the form of table, but we were also able to collect every data for the variables we wanted to use.

```{r}
df_list=list(
  black_actor_lead,
  black_actress_lead,
  latin_actor_lead,
  latin_actress_lead,
  asian_actor_lead,
  asian_actress_lead,
  egyptian_actor_lead,
  actor_sup,
  actress_sup,
  actor_lead, 
  actress_lead,
  highest_grossing,
  oscar_bo,
  female_winners,
  female_nom_bo,
  imdb_oscar)

for (df in df_list)
{
  print(sum(is.na(df)))
}
```

## Missing Values in Actress Lead and Actress Supporting

```{r}
tail(actress_lead,10)
tail(actress_sup,10)

```


```{r}
actress_lead <- actress_lead %>% drop_na()
```


```{r}
actress_sup <- actress_sup %>% drop_na()
```

<!--chapter:end:04-missing.Rmd-->

```{r include=FALSE, cache=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE
)
```
# Results

As a result of our project, we were able to find out that the number of people of color nominated for Oscars Best Actor and Best Supporting Actor has significantly increased over the years. The rate of the increase has accelerated towards recent years, and the diversity has also improved. We also found out that the movies with female lead roles take up only 17% of all-time Oscars Best Picture winners, and they are not necessarily as popular as the nominees with male lead roles. It is true that there were 8 cases during the first 50 years (1927 - around 1980) and 8 more during 25 years afterwards (1981-2005), but there were no such case after 2005 until now. 


```{r}
library(tidyverse)
library(stringr)
library(plotly)
library(ggrepel)
library(knitr)
library(gridExtra)
```


## Popular movies vs Oscar Winners 

```{r}
#manipulating tables
bo_oscar_highest_data <- left_join(oscar_bo, highest_grossing, by="Year") %>% select(Year, Overall_Movie, Overall_Boxoffice, Oscar_Movie, Oscar_Boxoffice)

rows <- nrow(bo_oscar_highest_data)

bo_oscar_temp <- bo_oscar_highest_data %>% select(Year, Oscar_Boxoffice, Oscar_Movie) %>% rename(Boxoffice = Oscar_Boxoffice, Movie = Oscar_Movie) %>% mutate(Group = rep("Oscar", rows))
bo_overall_temp <- bo_oscar_highest_data %>% select(Year, Overall_Boxoffice, Overall_Movie) %>% rename(Boxoffice = Overall_Boxoffice, Movie = Overall_Movie) %>% mutate(Group = rep("Overall", rows))

bo_oscar_highest_data <- rbind(bo_oscar_temp, bo_overall_temp)
```

```{r}
#plotting
# bo_oscar_highest_data %>% 
#   ggplot(aes(x = Year, y = Boxoffice, col = Group)) + 
#   geom_line(size = 1) +
#   scale_y_continuous(labels = scales::comma) +
#   theme_light() +
#   scale_color_manual(values = c("#FAC983", "#000000")) +
#   theme(legend.title= element_blank())


plot_ly() %>%
  add_lines(x = bo_oscar_temp$Year, y = bo_oscar_temp$Boxoffice, 
            color = I("#FAC983"), 
            name = "Oscar Best Picture",
            text = bo_oscar_temp$Movie,
            hoverinfo = 'text') %>%
  add_lines(x = bo_oscar_temp$Year, y = bo_overall_temp$Boxoffice, 
            color = I("black"), 
            name = "Highest Grossest Film",
            text = bo_overall_temp$Movie,
            hoverinfo = 'text') %>%
  layout(legend = list(x = 100, y = 0.5), title = 'Best Picture vs Highest Grossing Boxoffice')
```

The box office earnings of Oscar Best Picture have always been lower than the highest grossing movies. Whereas the box office of highest grossing movie has been increasing over the years, that for Oscar Best Picture stayed about the same over the years. In fact, the graph shows that the difference in the earnings has been increasing significantly, indicating that being critically acclaimed by bagging the Oscars Best Picture does not necessarily reflects the popularity of the movie.


```{r}
theme_oscars = function(base_size = 12, grid_width = 0.2) {
  bg_rect = element_rect(fill = "#EBAB47", color = "#EBAB47")

  theme_bw(base_size) +
    theme(
          plot.background = bg_rect,
          legend.background = bg_rect,
          panel.background = bg_rect,
          panel.grid.major = element_line(colour = "#3c3030", size = grid_width),
          panel.grid.minor = element_line(colour = "#3c3030", size = grid_width),
          legend.key.width = unit(1.5, "line"),
          legend.key = element_blank(),
          axis.title.x = element_text(margin = unit(c(0.5, 0.25, 0.5, 0.25), "line")),
          axis.title.y = element_text(margin = unit(c(0, 1, 0, 0.1), "line")),
          axis.ticks = element_blank(),
          panel.border = element_blank())
}
```


## Total Nominations and Wins of actors

```{r}
#data cleaning
all_actors <- data.frame(Actors = c(actor_lead$Actor, actor_sup$Actor))
all_actors_filter <- as.data.frame(table(all_actors))
all_actors_filter <- all_actors_filter %>% filter(Freq > 4) %>% arrange(all_actors)
actor_wins <- actor_wins %>% arrange(Name)
all_actors_filter <- all_actors_filter %>% mutate(Noms = all_actors_filter$Freq - actor_wins$Wins)

barplot_data <- function(actor, times, status) {
  
  new_df <- data.frame(Actor=character(0), Status=character(0))
  
  n <- length(actor)
  for(i in 1:n) {
  actor_rep <- rep(actor[i], times[i])
  status_rep <- rep(status, times[i])
  new_df <- rbind(new_df, data.frame(Actor = actor_rep, Status = status_rep))
  }
  return(new_df)
}

actor_wins_plot <- barplot_data(actor_wins$Name, actor_wins$Wins, "W")
actor_noms_plot <- barplot_data(all_actors_filter$all_actors, all_actors_filter$Noms, "N")
all_actors_new <- rbind(actor_wins_plot, actor_noms_plot)
all_actors_new <- all_actors_new %>% mutate(Status = as.factor(Status))

all_actors <- all_actors %>% filter(Actors %in% all_actors_filter$all_actors)
```

```{r}
#new plotting
all_actors_new %>% 
  ggplot(aes(x=fct_rev(fct_infreq(Actor)))) + 
  geom_bar(aes(fill=forcats::fct_rev(Status))) + 
  coord_flip() +
  ylab("Number of Oscar Nominations") +
  theme_oscars(base_size = 10, grid_width = 0.4) +
  theme(
    panel.grid.major.y = element_blank(),
    panel.grid.minor.y = element_blank(),
    plot.title = element_text(size = 15),
    plot.subtitle = element_text(hjust = 1.38, margin = unit(c(0.25, 0.25, 2, 0.25), "line")),
    axis.text.y = element_text(size = 10, margin = unit(c(0, -1, 0, 0), "line")),
    axis.title.y = element_blank(),
    axis.title.x = element_text(size = 10),
    legend.position = "none"
  ) + scale_fill_manual(values = c("#33a02c", "#000000")) +
  scale_y_continuous(breaks=c(0,2, 4, 6,8, 10, 12))
```

This is a barchart of actors who have been nominated for Best Actor and/or Best Supporting Actor more than four times, and the number of actual wins were colored differently. We can verify that most of them won the award at least once, and there seems to be a positive correlation between the number of nominations and the number of wins. The highest number of times an actor has won the award is 3, which was Jack Nicholson, and he also had the highest number of nominations. We have heard of almost everyone on this list, indicating the reputation of Oscars.



## Total Nominations and Wins of actresses

```{r}
#data cleaning
all_actress <- data.frame(Actress = c(actress_lead$Actress, actress_sup$Actress))
all_actress_filter <- as.data.frame(table(all_actress))

all_actress_filter <- all_actress_filter %>% filter(Freq > 4) %>% arrange(all_actress)
actress_wins <- actress_wins %>% arrange(Name)
all_actress_filter <- all_actress_filter %>% mutate(Noms = all_actress_filter$Freq - actress_wins$Wins)

actress_wins_plot <- barplot_data(actress_wins$Name, actress_wins$Wins, "W")
actress_noms_plot <- barplot_data(all_actress_filter$all_actress, all_actress_filter$Noms, "N")
all_actress_new <- rbind(actress_wins_plot, actress_noms_plot)
all_actress_new <- all_actress_new %>% mutate(Status = as.factor(Status))
```

```{r}
#new plotting
all_actress_new %>% 
  ggplot(aes(x=fct_rev(fct_infreq(Actor)))) + 
  geom_bar(aes(fill=forcats::fct_rev(Status))) + 
  coord_flip() +
  ylab("Number of Oscar Nominations") +
  theme_oscars(base_size = 10, grid_width = 0.4) +
  theme(
    panel.grid.major.y = element_blank(),
    panel.grid.minor.y = element_blank(),
    plot.title = element_text(size = 15),
    plot.subtitle = element_text(hjust = 1.38, margin = unit(c(0.25, 0.25, 2, 0.25), "line")),
    axis.text.y = element_text(size = 10, margin = unit(c(0, -1, 0, 0), "line")),
    axis.title.y = element_blank(),
    axis.title.x = element_text(size = 10),
    legend.position = "none"
  ) + scale_fill_manual(values = c("#33a02c", "#000000"))
```

This is a barchart of actresses who have been nominated for Best Actress and/or Best Supporting Actress more than four times, and the number of actual wins were colored differently. There are more actresses than actors of such case. Just lie the previous graph, we can see that most of them won the award at least once, and there seems to be a positive correlation between the number of nominations and the number of wins. The highest number of times an actor has won the award is 4, which was Katherine Hepburn, and she does not have the highest number of nominations. The one with the highest number of nominations is Meryl Streep, and she has won the award 3 times.



## Female-lead Movie Box Office vs Other Nominees that Year

```{r}
female_nom_bo %>% mutate(Status = ifelse(Status == "N", "Male-lead Nominee", "Female-lead Winner")) %>%
  ggplot(aes(x=as.factor(Year), y=Boxoffice, col=as.factor(Status)), label=Movie) +
  geom_point(size=2) +
  ylab("Boxoffice Earnings (in Millions)") +
  theme_light() +
  #geom_text(aes(label = ifelse(Movie %in% female_winners$Movie, Movie, "")),hjust=0, vjust=0, position = position_dodge()) +
  scale_color_manual(values = c("#000000", "#EBAB47")) +
  theme(axis.title.x = element_blank(), legend.title= element_blank(),
        legend.position = c(0.15, 0.9)) +
  geom_label_repel(aes(label = ifelse(Movie %in% female_winners$Movie, Movie, "")), size = 3, max.overlaps = Inf) +
  ggtitle("Comparing the Boxoffice earnings of female-lead Oscar Best Picture winners\n with the other nominees of that year")
```

In the history of Oscars from 1927 to 2021, there were only 16 years where movies with female lead role won the Best Picture. We compared the box office earnings of the wins and other nominees which are movies with male leads that year. The range of the earnings has been increasing over the years, and there were just a few years where the female-lead winners had the highest earnings among the nominated movies. The graph shows that Oscars winners with female leads are not necessarily more popular than the nominees of the same years.

## Average Rating of Oscar Nominees over Time

```{r}
imdb_oscar %>% group_by(Year) %>% 
  summarise(average_rating = mean(Rating)) %>%
  ggplot(aes(x=Year, y=average_rating)) + geom_line() + geom_point(col = "#ea2c0b") +
  ggtitle("Average audience rating of Oscar Best Picture nominees over the years") +
  ylab("Average Rating (out of 10)") +
  theme_oscars(base_size = 10, grid_width = 0.4)
```

Over the years, there has been a slight increasing trend in the average rating of Oscar nominees. The ratings range mostly from 7.25 to 8, and there seems to be less variance for more recent years.


## Average Runtime of Oscar Nominees over Time

```{r}
runtimePattern <- "\\smin"
imdb_oscar %>% 
  mutate(Time = as.numeric(str_replace(Time, runtimePattern, ""))) %>% 
  group_by(Year) %>% 
  summarise(average_runtime = mean(as.numeric(Time))) %>%
  ggplot(aes(x=Year, y=average_runtime)) + geom_line() + geom_point(col = "#ea2c0b") +
  ggtitle("Average runtime of Oscar Best Picture nominees over the years") +
  ylab("Average Runtime (mins)") +
  theme_oscars(base_size = 10, grid_width = 0.4)
```

Over the years, there has been a slight increasing trend in the average runtime of Oscar nominees. The average runtime of Oscar nominees range mostly from 110 to 150 minutes. There was a period from mid 1950s to mid 1960s where the runtime of Oscar movies were the highest, almost near 180 minutes.

## Average Runtime vs Rating of Oscar Best Picture Nominees

```{r}
runtimePattern <- "\\smin"
imdb_oscar %>% 
  mutate(Time = as.numeric(str_replace(Time, runtimePattern, ""))) %>%
  ggplot(aes(x=Time, y=Rating)) + geom_point(col = "#ea2c0b") +
  ggtitle("Audience Rating vs Runtime of Oscar Nominated Pictures") +
  xlab("Runtime (mins)") + ylab("Rating (out of 10)") +
  theme_oscars(base_size = 10, grid_width = 0.4)
```

We can see that a large proportion of the Oscar movies have runtime of 100 to 150 minutes and ratings of 7 to 8.5. There are just a few movies with ratings over 9 and below 6.5, or runtime over 150 minutes. There is not necessarily a correlation between runtime and ratings.


## Best Lead Actors Race over Time

The following a one graph showing the race of nominees (winners included) of Best Lead Actor over the years. We divided it into five graphs to accommodate all 100 years on the x-axis. We were able to find out that the number of people of color nominated for Oscars Best Actor and Best Supporting Actor has significantly increased over the years. The rate of the increase has accelerated towards recent years, and the diversity has also improved. 

```{r}
black_actor_lead <- black_actor_lead %>% mutate(Year = as.numeric(Year))
latin_actor_lead <- latin_actor_lead %>% mutate(Year = as.numeric(Year))
asian_actor_lead <- asian_actor_lead %>% mutate(Year = as.numeric(Year))
egyptian_actor_lead <- egyptian_actor_lead %>% mutate(Year = as.numeric(Year))
```

```{r}
#adding Race variable
actor_lead$Race <- ifelse(actor_lead$Actor %in% black_actor_lead$Name, "Black", 
       ifelse(actor_lead$Actor %in% latin_actor_lead$Nominee, "Latin", 
              ifelse(actor_lead$Actor %in% asian_actor_lead$Name, "Asian",
                     ifelse(actor_lead$Actor %in% egyptian_actor_lead$Name, "Egyptian", "White"))))

#adding an id var to plot
actor_lead <- actor_lead %>% group_by(Year) %>% mutate(id = 1:n())

#adding decade groups
actor_lead$TimePeriod <- ifelse(actor_lead$Year <= 1950, "1928-1950",
              ifelse(actor_lead$Year <= 1970, "1951-1970",
                     ifelse(actor_lead$Year <= 1990, "1971-1990",
                            ifelse(actor_lead$Year <= 2010, "1991-2010", "2011-2021"))))
```


```{r}
t1 <- actor_lead %>% filter(TimePeriod == "1928-1950") %>% 
  ggplot(aes(x = as.factor(Year), y = id, col = Race)) +
  geom_point(size = 5) +
  theme_light() +
  scale_color_manual(values = c("#E69F00", "#000000")) + theme(axis.title.x = element_blank(), axis.title.y = element_blank(), legend.title = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),  axis.ticks.y=element_blank(), axis.text.y=element_blank(), axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=0.2)) +
  geom_text_repel(aes(label = ifelse(Actor %in% c(black_actor_lead$Name, asian_actor_lead$Name, latin_actor_lead$Nominee, egyptian_actor_lead$Name), Actor, "")), size = 3, max.overlaps = Inf) +
  ggtitle("Actors: 1928-1950")

t1
```

```{r}
t2 <- actor_lead %>% filter(TimePeriod == "1951-1970") %>% 
  ggplot(aes(x = as.factor(Year), y = id, col = Race, label=Actor)) +
  geom_point(size = 5) +
  theme_light() +
  scale_color_manual(values = c("#56B4E9", "#CC79A7", "#E69F00", "#000000")) + 
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), legend.title = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.ticks.y=element_blank(), axis.text.y=element_blank(),
        axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=0.2)) +
  geom_text_repel(aes(label = ifelse(Actor %in% c(black_actor_lead$Name, asian_actor_lead$Name, latin_actor_lead$Nominee, egyptian_actor_lead$Name), Actor, "")), size = 3, max.overlaps = Inf) +
  ggtitle("Actors: 1951-1970")

t2
```

```{r}
t3 <- actor_lead %>% filter(TimePeriod == "1971-1990") %>% 
  ggplot(aes(x = as.factor(Year), y = id, col = Race, label=Actor)) +
  geom_point(size = 5) +
  theme_light() +
  scale_color_manual(values = c("#56B4E9", "#CC79A7", "#E69F00", "#000000")) + 
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), legend.title = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.ticks.y=element_blank(), axis.text.y=element_blank(),
        axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=0.2)) +
  geom_text_repel(aes(label = ifelse(Actor %in% c(black_actor_lead$Name, asian_actor_lead$Name, latin_actor_lead$Nominee, egyptian_actor_lead$Name), Actor, "")), size = 3, max.overlaps = Inf) +
  ggtitle("Actors: 1971-1990")

t3
```


```{r}
t4 <- actor_lead %>% filter(TimePeriod == "1991-2010") %>% 
  ggplot(aes(x = as.factor(Year), y = id, col = Race, label=Actor)) +
  geom_point(size = 5) +
  theme_light() +
  scale_color_manual(values = c("#56B4E9", "#CC79A7", "#000000")) + 
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), legend.title = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.ticks.y=element_blank(), axis.text.y=element_blank(),
        axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=0.2)) +
  geom_text_repel(aes(label = ifelse(Actor %in% c(black_actor_lead$Name, asian_actor_lead$Name, latin_actor_lead$Nominee, egyptian_actor_lead$Name), Actor, "")), size = 3, max.overlaps = Inf) +
  ggtitle("Actors: 1991-2010")

t4
```


```{r}
t5 <- actor_lead %>% filter(TimePeriod == "2011-2021") %>% 
  ggplot(aes(x = as.factor(Year), y = id, col = Race, label=Actor)) +
  geom_point(size = 5) +
  theme_light() +
  scale_color_manual(values = c("#56B4E9", "#CC79A7", "#33a02c", "#E69F00", "black")) + 
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), legend.title = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.ticks.y=element_blank(), axis.text.y=element_blank(),
        axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=0.2)) +
  geom_text_repel(aes(label = ifelse(Actor %in% c(black_actor_lead$Name, asian_actor_lead$Name, latin_actor_lead$Nominee, egyptian_actor_lead$Name), Actor, "")), size = 3, position = "dodge") +
  ggtitle("Actors: 2011-2021")

t5
```




<!--chapter:end:05-results.Rmd-->

```{r include=FALSE, cache=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE
)
```
# Interactive component

```{r}
library(shiny)
library(shinydashboard)
```


## IMDB Ratings of Oscar Movies over Time

https://shrtan.shinyapps.io/C_Graphics/
Click this link and try hovering over your mouse on the points. You will see the poster of the respetive movie. We decided to use the include interactivity here because there are too many data points. This way for each one you can clearly see the IMDB rating for each movie without being too overwhelmed by all the information. Since, even the year is divided by decade the user can find exactly what they want. 

The ratings of Oscar movies range mostly from 6.5 to 8.5, and there are just a few movies with ratings over 9 and below 6.5. We can see less movies with ratings under 7 for recent years compared to years before 1980.

```{r message=FALSE, warning=FALSE}
# Dashboard ----------------------------------------------------------------
ui <- dashboardPage(
  dashboardHeader(title = "Test"),
  dashboardSidebar(),
  dashboardBody(tags$head(tags$style(
    HTML("img.small-img {
          max-width: 75px;
          }")
  )),
  plotlyOutput("hoverplot"))
)

server <- function(input, output, session) {
  output$hoverplot <- renderPlotly({
    plot_ly(
      imdb_oscar,
      x         = ~ Year,
      y         = ~ Rating,
      type      = 'scatter',
      mode      = 'markers',
      hoverinfo = 'none',
      source = "hoverplotsource",
      customdata = ~ Image
    ) %>%
      event_register('plotly_hover') %>%
      event_register('plotly_unhover')
  })

  hover_event <- reactive({
    event_data(event = "plotly_hover", source = "hoverplotsource")
  })

  unhover_event <- reactive({
    event_data(event = "plotly_unhover", source = "hoverplotsource")
  })

  hoverplotlyProxy <- plotlyProxy("hoverplot", session)

  observeEvent(unhover_event(), {
    hoverplotlyProxy %>%
      plotlyProxyInvoke("relayout", list(images = list(NULL)))
  })

  observeEvent(hover_event(), {
    hoverplotlyProxy %>%
      plotlyProxyInvoke("relayout", list(images = list(
        list(
          source = hover_event()$customdata,
          xref = "x",
          yref = "y",
          x = hover_event()$x,
          y = hover_event()$y,
          sizex = 20,
          sizey = 20,
          opacity = 1
        )
      )))
  })
}

shinyApp(ui = ui, server = server)

#include_app(t, height = "400px")
```



<!--chapter:end:06-interactive.Rmd-->

```{r include=FALSE, cache=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE
)
```
# Conclusion

Through this project, we were able to gain the insights to answer our initial questions:
1)	Was there racial bias present when it came to choosing what movies were considered “good”? 
2)	Are movies that have female lead roles as popular as those that have male lead roles?

By exploring the data of the race of the nominees and winners of Best Actor over the years, we were able to find out that the number of people of color nominated has significantly increased over the years. The rate of the increase has accelerated towards recent years, and the diversity has also improved, especially with black actors. Based on our analysis, we could conclude that there has been racial bias towards white actors in the movie industry indicated by Oscars settings, and it has started to change quite recently. Another takeaway of this project was figuring out that only 17% of the Best Picture winners over the years was awarded to movies with female leads. This might have been caused both by the fact the number of movies with female leads are much less than those with male leads and that they have not been recognized enough by Oscars. While the proportion of people of color nominated for Best Actors has increased over time and it is continuing until now, the last Best Picture winner with female role was Million Dollar Baby in 2005 and there has been no more of such case since then. In addition, the winners with female leads do not necessarily have the highest box office earnings among other nominees that year. In the process of the analysis, we also found out that Oscar nominated movies mostly have ratings higher than 7, which indicates that people perceive those as decent movies, but almost none of them had the highest box office earnings that corresponding year. 

For this project, we created a custom theme for the graphs, only using color scheme that is accessible to people with color deficiency. We learned that collecting data that are appropriate for our purpose and cleaning them to make into specific forms we want takes the most time and effort for exploratory data analysis and data visualization. ~~MORE LIMITATIONS YOU FACED AND LESSONS LEARNED~~
One of the future directions of this project could be analyzing the race of the nominees and winners of Best Actress over the years and comparing the graph with that of Best Actor to see if there is any difference in the changes by gender. 

<!--chapter:end:07-conclusion.Rmd-->

